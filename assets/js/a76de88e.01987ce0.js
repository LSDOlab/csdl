"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7624],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var u=r.createContext({}),s=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=s(e.components);return r.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,u=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=a,h=d["".concat(u,".").concat(m)]||d[m]||c[m]||o;return n?r.createElement(h,i(i({ref:t},p),{},{components:n})):r.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=d;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},8317:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return u},metadata:function(){return s},toc:function(){return p},default:function(){return d}});var r=n(7462),a=n(3366),o=(n(7294),n(3905)),i=["components"],l={title:"Troubleshooting",sidebar_position:6},u="Troubleshooting",s={unversionedId:"troubleshooting",id:"troubleshooting",isDocsHomePage:!1,title:"Troubleshooting",description:"------------------------------------------------------------------------",source:"@site/docs/troubleshooting.mdx",sourceDirName:".",slug:"/troubleshooting",permalink:"/csdl/docs/troubleshooting",editUrl:"https://github.com/lsdolab/csdl/edit/main/website/docs/troubleshooting.mdx",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Troubleshooting",sidebar_position:6},sidebar:"docs",previous:{title:"Compiler Middle End Design",permalink:"/csdl/docs/optimizations"},next:{title:"Developer API",permalink:"/csdl/docs/developer/api"}},p=[{value:"I made a model, but when I run my program, nothing happens.",id:"i-made-a-model-but-when-i-run-my-program-nothing-happens",children:[]},{value:"Why can&#39;t I print variable values?",id:"why-cant-i-print-variable-values",children:[]},{value:"I get a shape mismatch error, but my shapes match",id:"broadcasting",children:[]},{value:"I get an &quot;Output not defined&quot; error, but I defined my output.",id:"i-get-an-output-not-defined-error-but-i-defined-my-output",children:[]},{value:"How to deal with errors in the back end",id:"how-to-deal-with-errors-in-the-back-end",children:[]}],c={toc:p};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"troubleshooting"},"Troubleshooting"),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"i-made-a-model-but-when-i-run-my-program-nothing-happens"},"I made a model, but when I run my program, nothing happens."),(0,o.kt)("p",null,"Assuming you created a class that inherits from ",(0,o.kt)("inlineCode",{parentName:"p"},"Model")," like so,"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},"from csdl import Model\nimport csdl\nimport numpy as np\n\n# This is nothing more than a class definition.\nclass Example(Model):\n    def define(self):\n        theta = self.declare_variable('theta', val=np.pi/4)\n        x = csdl.cos(theta)\n        y = csdl.sin(theta)\n        self.register_output('x', x)\n        self.register_output('y', y)\n\n# After the class is defined, nothing happens.\n")),(0,o.kt)("p",null,"then there is no way to execute the simulation because you did not issue\na command to the compiler to generate a simulation implementation or run\na simulation.\nIn order to generate a simulation implementation, use"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},"from backend import Simulator\n\n# Generate an implementation.\nsim = Simulator(Example())\n# Run simulation.\nsim.run()\n# Access values\nprint(sim['x'])\nprint(sim['y'])\n")),(0,o.kt)("p",null,"Note that the ",(0,o.kt)("inlineCode",{parentName:"p"},"Simulator")," constructor calls the ",(0,o.kt)("inlineCode",{parentName:"p"},"Model.define()"),"\nmethod automatically."),(0,o.kt)("h2",{id:"why-cant-i-print-variable-values"},"Why can't I print variable values?"),(0,o.kt)("p",null,"The Python ",(0,o.kt)("inlineCode",{parentName:"p"},"print")," function will print information about the CSDL\n",(0,o.kt)("inlineCode",{parentName:"p"},"Variable")," object, but not run time information.\nThis is because calling ",(0,o.kt)("inlineCode",{parentName:"p"},"print")," within ",(0,o.kt)("inlineCode",{parentName:"p"},"Model.define")," is a ",(0,o.kt)("em",{parentName:"p"},"compile\ntime")," operation, not a ",(0,o.kt)("em",{parentName:"p"},"run time operation"),".\nTo print variables at run time, the ",(0,o.kt)("inlineCode",{parentName:"p"},"Model.print_var")," method is\nprovided, which prints the CSDL variable name, shape, and value during\neach simulation run."),(0,o.kt)("h2",{id:"broadcasting"},"I get a shape mismatch error, but my shapes match"),(0,o.kt)("p",null,"CSDL variables do not support broadcasting."),(0,o.kt)("p",null,"Suppose you have a variable ",(0,o.kt)("inlineCode",{parentName:"p"},"a")," with shape ",(0,o.kt)("inlineCode",{parentName:"p"},"(2, 1)"),", and"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},"b = self.create_output('b', shape=(3,))\nb[:1] = a\n")),(0,o.kt)("p",null,"then this won't work because ",(0,o.kt)("inlineCode",{parentName:"p"},"b[:1]")," has shape ",(0,o.kt)("inlineCode",{parentName:"p"},"(2,)")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"a")," has shape\n",(0,o.kt)("inlineCode",{parentName:"p"},"(2,1)"),".\nInstead, use"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},"b = self.create_output('b', shape=(3,))\nb[:1] = csdl.reshape(a, (2,))\n")),(0,o.kt)("p",null,"For more complicated cases, you will need to use einsum."),(0,o.kt)("h2",{id:"i-get-an-output-not-defined-error-but-i-defined-my-output"},'I get an "Output not defined" error, but I defined my output.'),(0,o.kt)("p",null,"Either you forgot to define a value to your output using indexed\nassignment, or you made your variable reference a new object, neglecting\nthe original output you created."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},"# create an output\nx = self.create_output('x')\n# do some stuff without defining x...\n# bind x to a new object returned by f; now there is no reference to\n# the original output\nx = f(y)\n# register output, which is not the same as the output returned by\n# previous call to create_output\nself.register_output('x', x)\n")),(0,o.kt)("p",null,"Also remember that you do not need to register/rename the output using a\ncall to ",(0,o.kt)("inlineCode",{parentName:"p"},"register_output"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-py"},"x = self.create_output('x', shape=(2,))\nx[0] = f(y)\nx[1] = g(z)\n")),(0,o.kt)("h2",{id:"how-to-deal-with-errors-in-the-back-end"},"How to deal with errors in the back end"),(0,o.kt)("p",null,"The back end may emit error messages that look extremely unhelpful when\nusing CSDL.\nIn some cases, the back end will say there's an issue with a variable\ncalled ",(0,o.kt)("inlineCode",{parentName:"p"},"'_000H'"),", which is a name that CSDL automatically generates for\noutputs that the user does not register explicitly.\nThere may be a class that the back end uses with a similar name to a\nstandatd library function, or an operation with an automatically\ngenerated name."),(0,o.kt)("p",null,"To debug issues like this, register outputs in your model that are most\nlikely to be inputs and outputs of the operations that the back end uses\nto generate code.\nThis will not remove the error messages, but that ",(0,o.kt)("inlineCode",{parentName:"p"},"'_000H'")," will change\nto the name you set for your output.\nEventually, you should be able to find the source of the bug.\nThis does involve some trial end error."),(0,o.kt)("p",null,"There are a few reasons you've encountered this error"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"You used CSDL incorrectly (unlikely if the error is coming from the\nback end)."),(0,o.kt)("li",{parentName:"ul"},"There is a bug in the CSDL compiler back end (more likely than the\nfirst option)."),(0,o.kt)("li",{parentName:"ul"},"The CSDL compiler back end interacts with ",(0,o.kt)("inlineCode",{parentName:"li"},"csdl")," incorrectly (more\nlikely as the number of back ends increases).")),(0,o.kt)("p",null,"If you're sure the issue is the last one, or if you've spent a long time\ntrying to understand the bug and you've gotten nowhere, please file an\nissue on the GitHub issue tracker."))}d.isMDXComponent=!0}}]);